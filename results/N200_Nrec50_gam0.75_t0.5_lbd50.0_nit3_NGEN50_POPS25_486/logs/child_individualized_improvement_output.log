
combination: individualized improvement
savepath_it_config: results\N200_Nrec50_gam0.75_t0.5_lbd50.0_nit3_NGEN50_POPS25_486/0/improvement-individualized/
Node: x1, shift (mean, var): (0.5, 1.0)
fitting model with the specified parameters
model fit with accuracy 0.9
f1-score 0.9014084507042253
  0%|                                                                                                                | 0/25 [00:00<?, ?it/s]  4%|####1                                                                                                   | 1/25 [00:03<01:24,  3.52s/it]  8%|########3                                                                                               | 2/25 [00:03<00:39,  1.71s/it] 12%|############4                                                                                           | 3/25 [00:04<00:27,  1.26s/it] 16%|################6                                                                                       | 4/25 [00:05<00:19,  1.05it/s] 20%|####################8                                                                                   | 5/25 [00:05<00:15,  1.32it/s] 24%|########################9                                                                               | 6/25 [00:06<00:12,  1.51it/s] 28%|#############################1                                                                          | 7/25 [00:06<00:10,  1.69it/s] 32%|#################################2                                                                      | 8/25 [00:07<00:11,  1.49it/s] 36%|#####################################4                                                                  | 9/25 [00:08<00:10,  1.49it/s] 40%|#########################################2                                                             | 10/25 [00:08<00:10,  1.48it/s] 44%|#############################################3                                                         | 11/25 [00:10<00:13,  1.07it/s] 48%|#################################################4                                                     | 12/25 [00:11<00:12,  1.01it/s] 52%|#####################################################5                                                 | 13/25 [00:11<00:10,  1.14it/s] 56%|#########################################################6                                             | 14/25 [00:12<00:08,  1.29it/s] 60%|#############################################################8                                         | 15/25 [00:12<00:06,  1.45it/s] 64%|#################################################################9                                     | 16/25 [00:13<00:05,  1.59it/s] 68%|######################################################################                                 | 17/25 [00:14<00:04,  1.64it/s] 72%|##########################################################################1                            | 18/25 [00:14<00:04,  1.50it/s] 76%|##############################################################################2                        | 19/25 [00:15<00:04,  1.40it/s] 80%|##################################################################################4                    | 20/25 [00:16<00:04,  1.23it/s] 84%|######################################################################################5                | 21/25 [00:17<00:02,  1.36it/s] 88%|##########################################################################################6            | 22/25 [00:17<00:02,  1.44it/s] 92%|##############################################################################################7        | 23/25 [00:18<00:01,  1.39it/s] 96%|##################################################################################################8    | 24/25 [00:19<00:00,  1.44it/s]100%|#######################################################################################################| 25/25 [00:19<00:00,  1.45it/s]100%|#######################################################################################################| 25/25 [00:19<00:00,  1.25it/s]
savepath_shift: results\N200_Nrec50_gam0.75_t0.5_lbd50.0_nit3_NGEN50_POPS25_486/0/robustness/logreg-improvement-individualized-x1-mean0.5-var1.0/
Saving additional stats.
Invalidated perf of M2: 0.0
Validated perf of M2: 1.0
Validated perf of M1: 1.0
Node: x1, shift (mean, var): (0.0, 0.5)
fitting model with the specified parameters
model fit with accuracy 0.82
f1-score 0.8333333333333334
  0%|                                                                                                                | 0/44 [00:00<?, ?it/s]  2%|##3                                                                                                     | 1/44 [00:00<00:25,  1.70it/s]  5%|####7                                                                                                   | 2/44 [00:01<00:24,  1.70it/s]  7%|#######                                                                                                 | 3/44 [00:01<00:23,  1.77it/s]  9%|#########4                                                                                              | 4/44 [00:02<00:23,  1.71it/s] 11%|###########8                                                                                            | 5/44 [00:03<00:24,  1.60it/s] 14%|##############1                                                                                         | 6/44 [00:03<00:24,  1.56it/s] 16%|################5                                                                                       | 7/44 [00:04<00:24,  1.54it/s] 18%|##################9                                                                                     | 8/44 [00:05<00:24,  1.46it/s] 20%|#####################2                                                                                  | 9/44 [00:05<00:23,  1.50it/s] 23%|#######################4                                                                               | 10/44 [00:06<00:25,  1.32it/s] 25%|#########################7                                                                             | 11/44 [00:07<00:28,  1.17it/s] 27%|############################                                                                           | 12/44 [00:08<00:27,  1.15it/s] 30%|##############################4                                                                        | 13/44 [00:09<00:24,  1.25it/s] 32%|################################7                                                                      | 14/44 [00:09<00:22,  1.32it/s] 34%|###################################1                                                                   | 15/44 [00:10<00:21,  1.37it/s] 36%|#####################################4                                                                 | 16/44 [00:11<00:18,  1.51it/s] 39%|#######################################7                                                               | 17/44 [00:12<00:21,  1.26it/s] 41%|##########################################1                                                            | 18/44 [00:12<00:18,  1.39it/s] 43%|############################################4                                                          | 19/44 [00:13<00:16,  1.48it/s] 45%|##############################################8                                                        | 20/44 [00:13<00:15,  1.56it/s] 48%|#################################################1                                                     | 21/44 [00:15<00:17,  1.28it/s] 50%|###################################################5                                                   | 22/44 [00:15<00:16,  1.33it/s] 52%|#####################################################8                                                 | 23/44 [00:16<00:17,  1.17it/s] 55%|########################################################1                                              | 24/44 [00:17<00:18,  1.07it/s] 57%|##########################################################5                                            | 25/44 [00:18<00:17,  1.09it/s] 59%|############################################################8                                          | 26/44 [00:19<00:14,  1.25it/s] 61%|###############################################################2                                       | 27/44 [00:20<00:15,  1.11it/s] 64%|#################################################################5                                     | 28/44 [00:21<00:13,  1.22it/s] 66%|###################################################################8                                   | 29/44 [00:21<00:12,  1.20it/s] 68%|######################################################################2                                | 30/44 [00:22<00:11,  1.18it/s] 70%|########################################################################5                              | 31/44 [00:23<00:10,  1.30it/s] 73%|##########################################################################9                            | 32/44 [00:24<00:09,  1.23it/s] 75%|#############################################################################2                         | 33/44 [00:25<00:08,  1.32it/s] 77%|###############################################################################5                       | 34/44 [00:25<00:07,  1.39it/s] 80%|#################################################################################9                     | 35/44 [00:26<00:05,  1.51it/s] 82%|####################################################################################2                  | 36/44 [00:27<00:06,  1.26it/s] 84%|######################################################################################6                | 37/44 [00:28<00:06,  1.13it/s] 86%|########################################################################################9              | 38/44 [00:29<00:05,  1.10it/s] 89%|###########################################################################################2           | 39/44 [00:30<00:04,  1.08it/s] 91%|#############################################################################################6         | 40/44 [00:31<00:03,  1.05it/s] 93%|###############################################################################################9       | 41/44 [00:31<00:02,  1.18it/s] 95%|##################################################################################################3    | 42/44 [00:33<00:01,  1.08it/s] 98%|####################################################################################################6  | 43/44 [00:33<00:00,  1.19it/s]100%|#######################################################################################################| 44/44 [00:34<00:00,  1.34it/s]100%|#######################################################################################################| 44/44 [00:34<00:00,  1.29it/s]
savepath_shift: results\N200_Nrec50_gam0.75_t0.5_lbd50.0_nit3_NGEN50_POPS25_486/0/robustness/logreg-improvement-individualized-x1-mean0.0-var0.5/
Saving additional stats.
Invalidated perf of M2: 0.045454545454545456
Validated perf of M2: 0.9545454545454546
Validated perf of M1: 1.0
Node: x1, shift (mean, var): (0.5, 0.5)
fitting model with the specified parameters
model fit with accuracy 0.85
f1-score 0.8732394366197183
  0%|                                                                                                                | 0/22 [00:00<?, ?it/s]  5%|####7                                                                                                   | 1/22 [00:00<00:19,  1.06it/s]  9%|#########4                                                                                              | 2/22 [00:01<00:19,  1.01it/s] 14%|##############1                                                                                         | 3/22 [00:02<00:15,  1.23it/s] 18%|##################9                                                                                     | 4/22 [00:03<00:13,  1.36it/s] 23%|#######################6                                                                                | 5/22 [00:04<00:13,  1.28it/s] 27%|############################3                                                                           | 6/22 [00:04<00:11,  1.35it/s] 32%|#################################                                                                       | 7/22 [00:05<00:12,  1.25it/s] 36%|#####################################8                                                                  | 8/22 [00:06<00:12,  1.12it/s] 41%|##########################################5                                                             | 9/22 [00:07<00:12,  1.06it/s] 45%|##############################################8                                                        | 10/22 [00:08<00:10,  1.18it/s] 50%|###################################################5                                                   | 11/22 [00:09<00:08,  1.29it/s] 55%|########################################################1                                              | 12/22 [00:09<00:07,  1.32it/s] 59%|############################################################8                                          | 13/22 [00:10<00:06,  1.40it/s] 64%|#################################################################5                                     | 14/22 [00:11<00:05,  1.36it/s] 68%|######################################################################2                                | 15/22 [00:11<00:04,  1.50it/s] 73%|##########################################################################9                            | 16/22 [00:12<00:03,  1.59it/s] 77%|###############################################################################5                       | 17/22 [00:13<00:03,  1.35it/s] 82%|####################################################################################2                  | 18/22 [00:13<00:02,  1.42it/s] 86%|########################################################################################9              | 19/22 [00:14<00:02,  1.45it/s] 91%|#############################################################################################6         | 20/22 [00:15<00:01,  1.30it/s] 95%|##################################################################################################3    | 21/22 [00:16<00:00,  1.34it/s]100%|#######################################################################################################| 22/22 [00:16<00:00,  1.38it/s]100%|#######################################################################################################| 22/22 [00:16<00:00,  1.31it/s]
savepath_shift: results\N200_Nrec50_gam0.75_t0.5_lbd50.0_nit3_NGEN50_POPS25_486/0/robustness/logreg-improvement-individualized-x1-mean0.5-var0.5/
Saving additional stats.
Invalidated perf of M2: 0.0
Validated perf of M2: 1.0
Validated perf of M1: 0.9545454545454546
Node: x2, shift (mean, var): (0.5, 1.0)
fitting model with the specified parameters
model fit with accuracy 0.85
f1-score 0.9012345679012346
  0%|                                                                                                                | 0/18 [00:00<?, ?it/s]  6%|#####7                                                                                                  | 1/18 [00:00<00:09,  1.76it/s] 11%|###########5                                                                                            | 2/18 [00:01<00:10,  1.48it/s] 17%|#################3                                                                                      | 3/18 [00:01<00:09,  1.51it/s] 22%|#######################1                                                                                | 4/18 [00:02<00:11,  1.25it/s] 28%|############################8                                                                           | 5/18 [00:03<00:09,  1.44it/s] 33%|##################################6                                                                     | 6/18 [00:04<00:09,  1.24it/s] 39%|########################################4                                                               | 7/18 [00:05<00:09,  1.10it/s] 44%|##############################################2                                                         | 8/18 [00:06<00:08,  1.20it/s] 50%|####################################################                                                    | 9/18 [00:06<00:06,  1.33it/s] 56%|#########################################################2                                             | 10/18 [00:07<00:06,  1.23it/s] 61%|##############################################################9                                        | 11/18 [00:08<00:05,  1.32it/s] 67%|####################################################################6                                  | 12/18 [00:09<00:04,  1.37it/s] 72%|##########################################################################3                            | 13/18 [00:09<00:03,  1.37it/s] 78%|################################################################################1                      | 14/18 [00:11<00:03,  1.09it/s] 83%|#####################################################################################8                 | 15/18 [00:12<00:02,  1.10it/s] 89%|###########################################################################################5           | 16/18 [00:12<00:01,  1.22it/s] 94%|#################################################################################################2     | 17/18 [00:13<00:00,  1.35it/s]100%|#######################################################################################################| 18/18 [00:13<00:00,  1.36it/s]100%|#######################################################################################################| 18/18 [00:13<00:00,  1.29it/s]
savepath_shift: results\N200_Nrec50_gam0.75_t0.5_lbd50.0_nit3_NGEN50_POPS25_486/0/robustness/logreg-improvement-individualized-x2-mean0.5-var1.0/
Saving additional stats.
Invalidated perf of M2: 0.0
Validated perf of M2: 1.0
Validated perf of M1: 1.0
Node: x2, shift (mean, var): (0.0, 0.5)
fitting model with the specified parameters
model fit with accuracy 0.77
f1-score 0.8413793103448276
  0%|                                                                                                                | 0/17 [00:00<?, ?it/s]  6%|######1                                                                                                 | 1/17 [00:00<00:13,  1.23it/s] 12%|############2                                                                                           | 2/17 [00:01<00:09,  1.51it/s] 18%|##################3                                                                                     | 3/17 [00:02<00:09,  1.45it/s] 24%|########################4                                                                               | 4/17 [00:02<00:08,  1.49it/s] 29%|##############################5                                                                         | 5/17 [00:03<00:09,  1.24it/s] 35%|####################################7                                                                   | 6/17 [00:04<00:08,  1.36it/s] 41%|##########################################8                                                             | 7/17 [00:05<00:07,  1.33it/s] 47%|################################################9                                                       | 8/17 [00:05<00:06,  1.36it/s] 53%|#######################################################                                                 | 9/17 [00:06<00:05,  1.46it/s] 59%|############################################################5                                          | 10/17 [00:06<00:04,  1.58it/s] 65%|##################################################################6                                    | 11/17 [00:07<00:03,  1.62it/s] 71%|########################################################################7                              | 12/17 [00:08<00:03,  1.27it/s] 76%|##############################################################################7                        | 13/17 [00:09<00:02,  1.36it/s] 82%|####################################################################################8                  | 14/17 [00:09<00:02,  1.50it/s] 88%|##########################################################################################8            | 15/17 [00:10<00:01,  1.55it/s] 94%|################################################################################################9      | 16/17 [00:11<00:00,  1.51it/s]100%|#######################################################################################################| 17/17 [00:12<00:00,  1.33it/s]100%|#######################################################################################################| 17/17 [00:12<00:00,  1.41it/s]
savepath_shift: results\N200_Nrec50_gam0.75_t0.5_lbd50.0_nit3_NGEN50_POPS25_486/0/robustness/logreg-improvement-individualized-x2-mean0.0-var0.5/
Saving additional stats.
Invalidated perf of M2: 0.0
Validated perf of M2: 1.0
Validated perf of M1: 0.9411764705882353
Node: x2, shift (mean, var): (0.5, 0.5)
fitting model with the specified parameters
model fit with accuracy 0.8
f1-score 0.880503144654088
  0%|                                                                                                                | 0/12 [00:00<?, ?it/s]  8%|########6                                                                                               | 1/12 [00:00<00:07,  1.54it/s] 17%|#################3                                                                                      | 2/12 [00:01<00:09,  1.08it/s] 25%|##########################                                                                              | 3/12 [00:02<00:07,  1.13it/s] 33%|##################################6                                                                     | 4/12 [00:03<00:06,  1.33it/s] 42%|###########################################3                                                            | 5/12 [00:03<00:04,  1.41it/s] 50%|####################################################                                                    | 6/12 [00:04<00:03,  1.51it/s] 58%|############################################################6                                           | 7/12 [00:04<00:03,  1.54it/s] 67%|#####################################################################3                                  | 8/12 [00:05<00:02,  1.41it/s] 75%|##############################################################################                          | 9/12 [00:06<00:02,  1.44it/s] 83%|#####################################################################################8                 | 10/12 [00:07<00:01,  1.49it/s] 92%|##############################################################################################4        | 11/12 [00:07<00:00,  1.52it/s]100%|#######################################################################################################| 12/12 [00:08<00:00,  1.29it/s]100%|#######################################################################################################| 12/12 [00:08<00:00,  1.37it/s]
savepath_shift: results\N200_Nrec50_gam0.75_t0.5_lbd50.0_nit3_NGEN50_POPS25_486/0/robustness/logreg-improvement-individualized-x2-mean0.5-var0.5/
Saving additional stats.
Invalidated perf of M2: 0.0
Validated perf of M2: 1.0
Validated perf of M1: 1.0
Node: x3, shift (mean, var): (0.5, 1.0)
fitting model with the specified parameters
model fit with accuracy 0.81
f1-score 0.8571428571428572
  0%|                                                                                                                | 0/10 [00:00<?, ?it/s] 10%|##########4                                                                                             | 1/10 [00:00<00:07,  1.20it/s] 20%|####################8                                                                                   | 2/10 [00:01<00:05,  1.36it/s] 30%|###############################2                                                                        | 3/10 [00:02<00:05,  1.26it/s] 40%|#########################################6                                                              | 4/10 [00:02<00:04,  1.39it/s] 50%|####################################################                                                    | 5/10 [00:03<00:03,  1.28it/s] 60%|##############################################################4                                         | 6/10 [00:04<00:02,  1.37it/s] 70%|########################################################################8                               | 7/10 [00:05<00:02,  1.28it/s] 80%|###################################################################################2                    | 8/10 [00:06<00:01,  1.24it/s] 90%|#############################################################################################6          | 9/10 [00:06<00:00,  1.41it/s]100%|#######################################################################################################| 10/10 [00:07<00:00,  1.53it/s]100%|#######################################################################################################| 10/10 [00:07<00:00,  1.38it/s]
savepath_shift: results\N200_Nrec50_gam0.75_t0.5_lbd50.0_nit3_NGEN50_POPS25_486/0/robustness/logreg-improvement-individualized-x3-mean0.5-var1.0/
Saving additional stats.
Invalidated perf of M2: 0.2
Validated perf of M2: 0.8
Validated perf of M1: 1.0
Node: x3, shift (mean, var): (0.0, 0.5)
fitting model with the specified parameters
model fit with accuracy 0.86
f1-score 0.8987341772151898
  0%|                                                                                                                | 0/11 [00:00<?, ?it/s]  9%|#########4                                                                                              | 1/11 [00:00<00:05,  1.67it/s] 18%|##################9                                                                                     | 2/11 [00:01<00:05,  1.76it/s] 27%|############################3                                                                           | 3/11 [00:02<00:05,  1.38it/s] 36%|#####################################8                                                                  | 4/11 [00:03<00:05,  1.22it/s] 45%|###############################################2                                                        | 5/11 [00:03<00:04,  1.49it/s] 55%|########################################################7                                               | 6/11 [00:03<00:03,  1.62it/s] 64%|##################################################################1                                     | 7/11 [00:04<00:02,  1.34it/s] 73%|###########################################################################6                            | 8/11 [00:05<00:02,  1.47it/s] 82%|#####################################################################################                   | 9/11 [00:06<00:01,  1.56it/s] 91%|#############################################################################################6         | 10/11 [00:06<00:00,  1.69it/s]100%|#######################################################################################################| 11/11 [00:07<00:00,  1.77it/s]100%|#######################################################################################################| 11/11 [00:07<00:00,  1.56it/s]
savepath_shift: results\N200_Nrec50_gam0.75_t0.5_lbd50.0_nit3_NGEN50_POPS25_486/0/robustness/logreg-improvement-individualized-x3-mean0.0-var0.5/
Saving additional stats.
Invalidated perf of M2: 0.09090909090909091
Validated perf of M2: 0.9090909090909091
Validated perf of M1: 1.0
Node: x3, shift (mean, var): (0.5, 0.5)
fitting model with the specified parameters
model fit with accuracy 0.89
f1-score 0.941860465116279
  0%|                                                                                                                 | 0/6 [00:00<?, ?it/s] 17%|#################5                                                                                       | 1/6 [00:00<00:03,  1.62it/s] 33%|###################################                                                                      | 2/6 [00:01<00:02,  1.61it/s] 50%|####################################################5                                                    | 3/6 [00:02<00:02,  1.22it/s] 50%|####################################################5                                                    | 3/6 [00:02<00:02,  1.29it/s]
Process Process-1:
Traceback (most recent call last):
  File "C:\Users\akisl\new_anaconda3\envs\icr-env\lib\site-packages\multiprocess\process.py", line 315, in _bootstrap
    self.run()
  File "C:\Users\akisl\new_anaconda3\envs\icr-env\lib\site-packages\multiprocess\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Users\akisl\Desktop\self\FACT-UvA-2024\src\mcr\experiment\run.py", line 278, in run_recourse
    result_tpl_shift = recourse_population(
  File "C:\Users\akisl\Desktop\self\FACT-UvA-2024\src\mcr\recourse\population.py", line 106, in recourse_population
    scm_ = scm.abduct(obs, n_samples=nsamples)
  File "C:\Users\akisl\Desktop\self\FACT-UvA-2024\src\mcr\causality\scms\scm.py", line 338, in abduct
    scm_abd.model[node]["noise_distribution"] = self.abduct_node(
  File "C:\Users\akisl\Desktop\self\FACT-UvA-2024\src\mcr\causality\scms\scm.py", line 323, in abduct_node
    return self._abduct_node_obs_mcmc(node, obs, **kwargs)
  File "C:\Users\akisl\Desktop\self\FACT-UvA-2024\src\mcr\causality\scms\generic.py", line 353, in _abduct_node_obs_mcmc
    d_node = self._abduct_node_obs_discrete(node, obs)
  File "C:\Users\akisl\Desktop\self\FACT-UvA-2024\src\mcr\causality\scms\generic.py", line 263, in _abduct_node_obs_discrete
    return dist.Binomial(probs=np.exp(log_posterior_y(1)), total_count=1)
  File "C:\Users\akisl\Desktop\self\FACT-UvA-2024\src\mcr\causality\scms\generic.py", line 257, in log_posterior_y
    nominator = log_prob_joint(y)
  File "C:\Users\akisl\Desktop\self\FACT-UvA-2024\src\mcr\causality\scms\generic.py", line 253, in log_prob_joint
    log_probs.append(d_y.log_prob(y))
  File "C:\Users\akisl\new_anaconda3\envs\icr-env\lib\site-packages\numpyro\distributions\util.py", line 675, in wrapper
    log_prob = log_prob_fn(self, *args, **kwargs)
  File "C:\Users\akisl\new_anaconda3\envs\icr-env\lib\site-packages\numpyro\distributions\discrete.py", line 91, in log_prob
    return xlogy(value, ps_clamped) + xlog1py(1 - value, -ps_clamped)
  File "C:\Users\akisl\new_anaconda3\envs\icr-env\lib\site-packages\jax\_src\traceback_util.py", line 179, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "C:\Users\akisl\new_anaconda3\envs\icr-env\lib\site-packages\jax\_src\custom_derivatives.py", line 259, in __call__
    out_flat = custom_jvp_call_p.bind(flat_fun, flat_jvp, *args_flat,
  File "C:\Users\akisl\new_anaconda3\envs\icr-env\lib\site-packages\jax\_src\custom_derivatives.py", line 361, in bind
    outs = top_trace.process_custom_jvp_call(self, fun, jvp, tracers,  # type: ignore
  File "C:\Users\akisl\new_anaconda3\envs\icr-env\lib\site-packages\jax\_src\core.py", line 949, in process_custom_jvp_call
    return fun.call_wrapped(*tracers)
  File "C:\Users\akisl\new_anaconda3\envs\icr-env\lib\site-packages\jax\_src\linear_util.py", line 191, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "C:\Users\akisl\new_anaconda3\envs\icr-env\lib\site-packages\jax\_src\scipy\special.py", line 161, in xlog1py
    return jnp.where(x_ok, lax.mul(x, lax.log1p(y)), jnp.zeros_like(x))
  File "C:\Users\akisl\new_anaconda3\envs\icr-env\lib\site-packages\jax\_src\numpy\lax_numpy.py", line 1146, in where
    return util._where(acondition, if_true, if_false)
KeyboardInterrupt
